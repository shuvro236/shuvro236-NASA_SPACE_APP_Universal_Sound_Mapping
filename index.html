<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Solar System with Zoom on Click</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/GLTFLoader.js"></script>

    <script>
        let selectedPlanet = null;
        let zooming = false;

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Add OrbitControls for zooming and rotation
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableZoom = true;

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        const loader = new THREE.GLTFLoader();

        loader.load('assets/Sun.glb', gltf => {
            const sun = gltf.scene;
            sun.scale.set(0.1, 0.1, 0.1);
            scene.add(sun);

            // Set the Sun's rotation speed
            sun.userData = {
                rotationSpeed: 0.001
            };

            //light
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(20, 20, 20).normalize();
            scene.add(directionalLight);

            //Sun's rotation
            function animateSun() {
                sun.rotation.y += sun.userData.rotationSpeed;
            }

            // planet
            const planetsData = [
    { name: "Mercury", model: "assets/Mercury.glb", distance: 57.91 * 10, orbitPeriod: 87.96 * 10, rotationPeriod: 58.64 * 10, axialTilt: 0 },
    { name: "Venus", model: "assets/Venus.glb", distance: 108.20 * 10, orbitPeriod: 224.68 * 10, rotationPeriod: 243 * 10, axialTilt: 177.4 },
    { name: "Earth", model: "assets/Earth.glb", distance: 149.60 * 10, orbitPeriod: 365.26 * 10, rotationPeriod: 1 * 10, axialTilt: 23.4 },
    { name: "Mars", model: "assets/Mars.glb", distance: 227.90 * 10, orbitPeriod: 686.95 * 10, rotationPeriod: 1.025 * 10, axialTilt: 25.2 },
    { name: "Jupiter", model: "assets/Jupiter.glb", distance: 778.57 * 10, orbitPeriod: 4332.59 * 10, rotationPeriod: 0.41 * 10, axialTilt: 3.1 },
    { name: "Saturn", model: "assets/Saturn.glb", distance: 1433.53 * 10, orbitPeriod: 10759 * 10, rotationPeriod: 0.45 * 10, axialTilt: 26.7 },
    { name: "Uranus", model: "assets/Uranus.glb", distance: 2872.46 * 10, orbitPeriod: 30687 * 10, rotationPeriod: -0.72 * 10, axialTilt: 97.8 }, // Negative for retrograde rotation
    { name: "Neptune", model: "assets/Neptune.glb", distance: 4495.06 * 5, orbitPeriod: 60190 * 10, rotationPeriod: 0.67 * 10, axialTilt: 28.3 }
];


            const planets = [];

            // text
            function createTextLabel(text) {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 1012;  
                canvas.height = 728;
                context.font = 'Bold 100px Arial';
                context.fillStyle = 'white';
                context.fillText(text, 0, 64);  
                const texture = new THREE.CanvasTexture(canvas);
                texture.needsUpdate = true;
                const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
                const sprite = new THREE.Sprite(spriteMaterial);
                sprite.scale.set(25, 12.5, 1);  
                return sprite;
            }

            // Load 3D model and add labels
            planetsData.forEach(data => {
                loader.load(data.model, gltf => {
                    const planet = gltf.scene;
                    planet.scale.set(0.02, 0.02, 0.02);  // Adjust the scale
                    scene.add(planet);

                    planet.userData = {
                        name: data.name,
                        distance: data.distance / 10,  // Scaling down for visualization
                        orbitSpeed: (1 / data.orbitPeriod) * 1,
                        rotationSpeed: (1 / data.rotationPeriod) * .05,  // Speed for planet self-rotation
                        angle: Math.random() * Math.PI * 2,
                        axialTilt: data.axialTilt
                    };

                    planet.rotation.z = THREE.MathUtils.degToRad(planet.userData.axialTilt);

                    // Add the planet to the array for future updates
                    planets.push(planet);

                    // Add a text label near the planet (as a separate object)
                    const label = createTextLabel(data.name);
                    label.position.set(planet.position.x, planet.position.y + 15, planet.position.z);  // Place it above the planet
                    planet.userData.label = label;
                    scene.add(label);
                }, undefined, error => {
                    console.error('Error loading model:', error);
                });
            });

            //camera position
            camera.position.z = 1100;

            function animate() {
                requestAnimationFrame(animate);
                animateSun();

                //planet's orbit and self-rotation
                planets.forEach(planet => {
                    if (planet.userData) {
                        planet.userData.angle += planet.userData.orbitSpeed;

                        // position based on orbit
                        planet.position.x = planet.userData.distance * Math.cos(planet.userData.angle);
                        planet.position.z = planet.userData.distance * Math.sin(planet.userData.angle);

                        //its axis
                        planet.rotation.y += planet.userData.rotationSpeed;

                        // the label
                        planet.userData.label.position.set(planet.position.x, planet.position.y + 15, planet.position.z);

                        // Scale the label based on distance from camera
                        const distance = camera.position.distanceTo(planet.position);
                        const scale = Math.max(50, 20000 / distance);  
                        planet.userData.label.scale.set(scale, scale, scale);
                    }
                });

                //zoom to selected planet
                if (selectedPlanet && zooming) {
                    camera.position.lerp(new THREE.Vector3(
                        selectedPlanet.parent.position.x,
                        selectedPlanet.parent.position.y + 5,
                        selectedPlanet.parent.position.z + 10
                    ), 0.05);
                    camera.lookAt(selectedPlanet.parent.position);
                }

                controls.update();

                renderer.render(scene, camera);
            }

            animate();

            window.addEventListener('resize', () => {
                const width = window.innerWidth;
                const height = window.innerHeight;
                renderer.setSize(width, height);
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
            });

            // Mouse click event
            window.addEventListener('click', (event) => {
                mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(planets, true);

                if (intersects.length > 0) {
                    // Zoom to the parent object of the intersected planet
                    selectedPlanet = intersects[0].object;
                    zooming = true;
                }
            });

            //reset camera to the initial view
            window.addEventListener('dblclick', () => {
                selectedPlanet = null;
                zooming = false;
                camera.position.set(0, 0, 400);
            });
        }, undefined, error => {
            console.error('Error loading Sun model:', error);
        });
    </script>
</body>
</html>
